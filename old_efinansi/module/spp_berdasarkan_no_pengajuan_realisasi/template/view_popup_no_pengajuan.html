<!-- patTemplate:tmpl name="content" -->
<script language="javascript" type="text/javascript">
/**
function addKomponen(id,kegrefId,nominal)
{
    unitId =0;
    alert(id+ ' '+ kegrefId + ' '+ nominal + ' '+ unitId);
}

function setParent(id,nama, harga_satuan)
{

   var form = document.forms['frmInput'];
   document.getElementById('komponen_id').value = id;
   document.getElementById('komponen_nama_ro').value= nama; 
   document.getElementById('komponen_nama_hidden').value= nama; 
   document.getElementById('komponen_nominal').gvSetValue(harga_satuan);
   //form.komponen_id.value = id;
   //form.komponen_nama_ro.value= nama;   
   //form.komponen_nama_hidden.value= nama;      
   //form.komponen_nominal.gvSetValue(harga_satuan);
   popupClose();
}
*/

function cekPengajuanId(maks,pengajuan_id)
{ 
    var nopeng_arrary = new Array();
    for(j = 0; j < maks; j++){
		if(document.getElementById('nopeng_'+j)){
			nopeng_arrary[j] = document.getElementById('nopeng_'+j).value;
		}   
	}
   //var idStr = idObj.toString();
   //return idStr.search(komp_id);
   var cek = nopeng_arrary.indexOf(pengajuan_id);
   if( cek != -1){
        return true;
   } else {
        return false;
   }
}
function setParent(obj,pengajuan_id,pengajuan_detail_id,pengajuan_no,pengajuan_tgl,pengajuan_tgl_label,nominal,nominal_label,kode_ma,nama_index) 
{ 
   var random=Math.floor(Math.random()*666);
   var nomor =  document.getElementById("nomor");
   var maks =  document.getElementById('maks');
   var maks_nomor =  document.getElementById('maks_nomor');
   /**
    untuk membuat kolom tabel
    */
   var tr = document.createElement('tr');
   var td_no = document.createElement('td');
   var td_nomor_pengajuan = document.createElement('td');
   var td_tgl_pengajuan = document.createElement('td');
   var td_nominal = document.createElement('td');
   var td_nama_index = document.createElement('td');
   var td_kode_ma = document.createElement('td');
   var td_catatan = document.createElement('td');
   var td_aksi = document.createElement('td');
   var tbodi = document.getElementById("table-pengajuan");
   var tr_kosong = document.getElementById("table-kosong");
  /**
  end
  */
   i = parseInt(maks.value);
   nm = parseInt(maks_nomor.value);
   id = i +1;
   
   
    if(cekPengajuanId(id,pengajuan_detail_id) == true){
        alert('Item Pengajuan Sudah Ada');
        
    } else {
		
   maks.value = id;
   
   
   maks.value = id;
   maks_nomor.value = nm + 1;
   no = nm + 1;
   td_no.innerHTML = '<input type="hidden" name="nomor" id="h_no_urut_'+id+'" value="'+no+'" />'+
					 '<label id="no_urut_'+id+'">'+no+'</label>';   
   td_nomor_pengajuan.innerHTML ='<input type="hidden" id="nopeng_'+id+'" value="'+pengajuan_detail_id+'" />'+
                    '<input type="hidden" name="pengajuan['+id+'][pengajuan_id]" value="'+pengajuan_id+'" />'+
                    '<input type="hidden" name="pengajuan['+id+'][pengajuan_detail_id]" value="'+pengajuan_detail_id+'" />'+
                    '<input type="hidden" name="pengajuan['+id+'][pengajuan_no]" value="'+pengajuan_no+'"/>'+pengajuan_no;  
   td_tgl_pengajuan.innerHTML = '<input type="hidden" name="pengajuan['+id+'][tanggal_pengajuan]" value="'+pengajuan_tgl+'" />'+
					 '<label>'+pengajuan_tgl_label+'</label>';   
   td_nominal.innerHTML = '<input type="text" name="pengajuan['+id+'][nominal]" size="20" value="'+nominal+'" id="pengajuan_'+ id +'" class="gvNum"/>';
   td_kode_ma.innerHTML = '<input type="hidden" name="pengajuan['+id+'][kode_ma]" size="20" value="'+kode_ma+'" />'+
						'<label>'+kode_ma+'</label>'; 
   td_nama_index.innerHTML = '<input type="hidden" name="pengajuan['+id+'][nama_index]" size="20" value="'+nama_index+'" />'+
						'<label>'+nama_index+'</label>'; 
   td_catatan.innerHTML = '<textarea cols="15" rows="3" name="pengajuan['+id+'][catatan]"></textarea>'; 
   td_aksi.innerHTML =  '<a href="javascript:void(null)" title="Hapus" onclick="hapusPengajuan(this)">'+
                      '<img src="images/button-delete.gif" alt="Hapus" /></a>';
   td_aksi.style.textAlign='center';
   td_no.style.textAlign='center';
   td_nominal.style.textAlign='right';
   
   tr.appendChild(td_no);
   tr.appendChild(td_nomor_pengajuan);
   tr.appendChild(td_tgl_pengajuan);
   tr.appendChild(td_kode_ma);
   tr.appendChild(td_nama_index);
   tr.appendChild(td_nominal);
   tr.appendChild(td_catatan);
   tr.appendChild(td_aksi);
  
   //tbodi.appendChild(tr);
   
   if(tr_kosong){
	   tbodi.replaceChild(tr,tr_kosong);
   } else{
	tbodi.appendChild(tr);
   }	
     
   obj.style.display='none';
   Behaviour.apply();  
   totalKomponenAnggaran();
   
   }
}
   
</script>

<h1>
List Nomor Pengajuan
</h1>
<br />
<form method="POST" action="{URL_SEARCH}" class="dataquest xhr_simple_form dest_popup-subcontent" id="filterboxpopup">
   <table>
      <tr>
         <th colspan="2"><h2><strong><!-- patTemplate:gtfwgetconfig config="language" name="pencarian" / --></strong></h2></th>
      </tr>
      <tr>              
         <th width="150">Nomor Pengajuan</th>
         <td><input type="text" name="no_pengajuan" value="{NO_PENGAJUAN}" size="30" /></td>
      </tr>      
      <tr>
         <th>&nbsp;</th>
         <td>
            <input type="submit" name="btncari" value=" Tampilkan &raquo;" class="buttonSubmit"/>
         </td>
      </tr>
   </table>
</form>
<br />  
   <div class="pageBar">
   <!-- patTemplate:gtfwrendermodule module="paging" submodule="paging" action="view" name="paging_top"  / -->
   </div>
   <br />
   <table class="table-common" width="100%">
      <tr>
         <th width="5"><!-- patTemplate:gtfwgetconfig config="language" name="no" / --></th>         
         <th>Kode MA</th>
         <th>Nomor Pengajuan / Nama Index</th>
         <th width="100">Tanggal</th>
         <th>Nominal</th>
         <th width="31"><!-- patTemplate:gtfwgetconfig config="language" name="aksi" / --></th>
      </tr>
      <!-- patTemplate:tmpl name="data_pengajuan" type="condition" conditionvar="IS_EMPTY" -->
         <!-- patTemplate:sub condition="YES" -->
         <tr><td colspan="9" align="center"><em>--<!-- patTemplate:gtfwgetconfig config="language" name="data_kosong" / -->--</em></td></tr>
         <!-- /patTemplate:sub -->
         <!-- patTemplate:sub condition="NO" -->
         
            <!-- patTemplate:tmpl name="data_pengajuan_item" -->
            <tr >
               <td align="center">{DATA_NUMBER}</td>
               <td>{DATA_KODE_MA}</td>
               <td>{DATA_KETERANGAN}</td>
               <td>{DATA_TANGGAL_PENGAJUAN_LABEL}</td>
               <td align="right">{DATA_NOMINAL_TOTAL_SPP_F}</td>
               <td class="links" align="center">
				      <!-- patTemplate:tmpl name="action" visibility="hidden" -->
						<a href="javascript:void(0)" onclick="javascript:setParent(this,'{DATA_ID_PENGAJUAN}','{DATA_ID_PENGAJUAN_DETAIL}','{DATA_NOMOR_PENGAJUAN}','{DATA_TANGGAL_PENGAJUAN}','{DATA_TANGGAL_PENGAJUAN_LABEL}','{DATA_NOMINAL_TOTAL_SPP}','{DATA_NOMINAL_TOTAL_SPP_F}','{DATA_KODE_MA}','{DATA_NAMA_INDEX}')"><img alt="Pilih" src="images/button-check.gif"/></a>
					  <!-- /patTemplate:tmpl -->	
               </td>			   
            </tr>
            <!-- /patTemplate:tmpl -->
         <!-- /patTemplate:sub -->
      <!-- /patTemplate:tmpl -->
   </table>
<div>
<!-- /patTemplate:tmpl -->